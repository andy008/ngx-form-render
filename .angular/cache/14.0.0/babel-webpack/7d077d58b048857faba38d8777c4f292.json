{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"../field-builder/field-builder.component\";\nconst _c0 = [\"formDirective\"];\n\nfunction FormBuilderComponent_div_0_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction FormBuilderComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3)(2, \"div\", 4);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 5);\n    i0.ɵɵtemplate(5, FormBuilderComponent_div_0_ng_container_5_Template, 1, 0, \"ng-container\", 6);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n\n    const _r2 = i0.ɵɵreference(3);\n\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.formTitle);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", _r2);\n  }\n}\n\nfunction FormBuilderComponent_div_1_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction FormBuilderComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵtemplate(1, FormBuilderComponent_div_1_ng_container_1_Template, 1, 0, \"ng-container\", 6);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r2 = i0.ɵɵreference(3);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", _r2);\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_div_2_div_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"lib-field-builder\", 12);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const field_r13 = ctx.$implicit;\n    const ctx_r12 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"form\", ctx_r12.form)(\"field\", field_r13)(\"labelClass\", ctx_r12.formConfig.labelClass);\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_div_2_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, FormBuilderComponent_ng_template_2_div_2_div_1_div_1_Template, 2, 3, \"div\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const section_r11 = ctx.$implicit;\n    i0.ɵɵclassMap(section_r11.class);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", section_r11.fields);\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, FormBuilderComponent_ng_template_2_div_2_div_1_Template, 2, 3, \"div\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const column_r9 = ctx.$implicit;\n    i0.ɵɵclassMap(column_r9.class);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", column_r9.sections);\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_div_3_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function FormBuilderComponent_ng_template_2_div_3_button_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r17.cancel());\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext(3);\n    i0.ɵɵclassMap(ctx_r14.cancelClass);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r14.cancelButton, \" \");\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_div_3_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function FormBuilderComponent_ng_template_2_div_3_button_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r19.reset());\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext(3);\n    i0.ɵɵclassMap(ctx_r15.resetClass);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r15.resetButton, \" \");\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_div_3_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function FormBuilderComponent_ng_template_2_div_3_button_3_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r21.submit());\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r16 = i0.ɵɵnextContext(3);\n    i0.ɵɵclassMap(ctx_r16.saveClass);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r16.saveButton, \" \");\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵtemplate(1, FormBuilderComponent_ng_template_2_div_3_button_1_Template, 2, 3, \"button\", 14);\n    i0.ɵɵtemplate(2, FormBuilderComponent_ng_template_2_div_3_button_2_Template, 2, 3, \"button\", 15);\n    i0.ɵɵtemplate(3, FormBuilderComponent_ng_template_2_div_3_button_3_Template, 2, 3, \"button\", 14);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.cancelButton);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.resetButton);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.saveButton);\n  }\n}\n\nfunction FormBuilderComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"form\", 7, 8);\n    i0.ɵɵtemplate(2, FormBuilderComponent_ng_template_2_div_2_Template, 2, 3, \"div\", 9);\n    i0.ɵɵtemplate(3, FormBuilderComponent_ng_template_2_div_3_Template, 4, 3, \"div\", 10);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵclassMap(ctx_r3.formConfig.formClass);\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.form);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.formConfig.columns);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.formConfig.showControls);\n  }\n}\n\nexport let FormBuilderComponent = /*#__PURE__*/(() => {\n  class FormBuilderComponent {\n    constructor() {\n      this.formTitle = '';\n      this.fields = [];\n      this.saveButton = '';\n      this.resetButton = '';\n      this.cancelButton = '';\n      this.sendFormData = new EventEmitter();\n    }\n\n    ngOnInit() {\n      let fieldsCtrls = {};\n      this.formTitle = this.formConfig['title'];\n      this.saveClass = this.formConfig.saveButtonClass == '' ? 'btn btn-primary m-1' : this.formConfig.controls.saveButtonClass;\n      this.resetClass = this.formConfig.resetButtonClass == '' ? 'btn btn-outline-warning m-1' : this.formConfig.controls.resetButtonClass;\n      this.cancelClass = this.formConfig.cancelButtonClass == '' ? 'btn btn-outline-warning m-1' : this.formConfig.controls.cancelButtonClass;\n\n      for (const key1 in this.formConfig['columns']) {\n        let column = this.formConfig.columns[key1];\n\n        for (const key2 in column['sections']) {\n          let section = column.sections[key2];\n\n          for (const key3 in section['fields']) {\n            let field = section.fields[key3];\n\n            if (field === null || field === void 0 ? void 0 : field.required) {\n              let validators = [Validators.required];\n\n              if (field.type == 'checkbox') {\n                validators = [Validators.requiredTrue]; //pattern('true')\n              }\n\n              if ((field === null || field === void 0 ? void 0 : field.type) === 'email') {\n                validators.push(Validators.email);\n              }\n\n              if (field === null || field === void 0 ? void 0 : field.minLength) {\n                validators.push(Validators.minLength(field.minLength));\n              }\n\n              if (field === null || field === void 0 ? void 0 : field.maxLength) {\n                validators.push(Validators.maxLength(field.maxLength));\n              }\n\n              if (field === null || field === void 0 ? void 0 : field.pattern) {\n                validators.push(Validators.pattern(field.pattern));\n              }\n\n              fieldsCtrls[field.name] = new FormControl(field.value || '', validators);\n            } else {\n              fieldsCtrls[field.name] = new FormControl(field.value || '');\n            }\n\n            ;\n          }\n\n          ;\n        }\n\n        ;\n      }\n\n      ;\n\n      if (this.formConfig && this.formConfig['controls'] && this.formConfig['controls']['saveButton']) {\n        this.saveButton = this.formConfig['controls']['saveButton'];\n      }\n\n      if (this.formConfig && this.formConfig['controls'] && this.formConfig['controls']['resetButton']) {\n        this.resetButton = this.formConfig['controls']['resetButton'];\n      }\n\n      if (this.formConfig && this.formConfig['controls'] && this.formConfig['controls']['cancelButton']) {\n        this.cancelButton = this.formConfig['controls']['cancelButton'];\n      }\n\n      this.form = new FormGroup(fieldsCtrls);\n    }\n\n    submit() {\n      if (this.getFormValidationErrors(this.form).length) {\n        this.form.markAllAsTouched();\n      } else {\n        this.sendFormData.emit(this.form);\n      }\n    }\n\n    cancel() {\n      this.sendFormData.emit(null);\n    }\n\n    reset() {\n      try {\n        document.getElementById('clearFile').click();\n      } catch (error) {}\n\n      this.formDirective.resetForm();\n      this.form.reset();\n    }\n\n    getFormValidationErrors(form) {\n      const result = [];\n      Object.keys(form.controls).forEach(key => {\n        const controlErrors = form.get(key).errors;\n\n        if (controlErrors) {\n          Object.keys(controlErrors).forEach(keyError => {\n            result.push({\n              'control': key,\n              'error': keyError,\n              'value': controlErrors[keyError]\n            });\n          });\n        }\n      });\n      console.log(result);\n      return result;\n    }\n\n  }\n\n  FormBuilderComponent.ɵfac = function FormBuilderComponent_Factory(t) {\n    return new (t || FormBuilderComponent)();\n  };\n\n  FormBuilderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FormBuilderComponent,\n    selectors: [[\"lib-form-engine\"]],\n    viewQuery: function FormBuilderComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.formDirective = _t.first);\n      }\n    },\n    inputs: {\n      formConfig: \"formConfig\"\n    },\n    outputs: {\n      sendFormData: \"sendFormData\"\n    },\n    decls: 4,\n    vars: 2,\n    consts: [[\"class\", \"col-lg-12 col-md-12 col-sm-12\", 4, \"ngIf\"], [\"formBuilder\", \"\"], [1, \"col-lg-12\", \"col-md-12\", \"col-sm-12\"], [1, \"card\"], [1, \"card-header\"], [1, \"card-body\"], [4, \"ngTemplateOutlet\"], [3, \"formGroup\"], [\"formDirective\", \"ngForm\"], [3, \"class\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"col-md-12 text-right\", 4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"form\", \"field\", \"labelClass\"], [1, \"col-md-12\", \"text-right\"], [\"type\", \"button\", 3, \"class\", \"click\", 4, \"ngIf\"], [\"type\", \"reset\", 3, \"class\", \"click\", 4, \"ngIf\"], [\"type\", \"button\", 3, \"click\"], [\"type\", \"reset\", 3, \"click\"]],\n    template: function FormBuilderComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, FormBuilderComponent_div_0_Template, 6, 2, \"div\", 0);\n        i0.ɵɵtemplate(1, FormBuilderComponent_div_1_Template, 2, 1, \"div\", 0);\n        i0.ɵɵtemplate(2, FormBuilderComponent_ng_template_2_Template, 4, 5, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.formTitle);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.formTitle);\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgIf, i1.NgTemplateOutlet, i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.FormGroupDirective, i3.FieldBuilderComponent]\n  });\n  return FormBuilderComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}